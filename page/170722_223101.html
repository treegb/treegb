<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../css/css_coreNote_001.css">
<link rel="shortcut icon" href="../img/treegb_icon.ico">
<title>Command</title>
</head>

<style type="text/css">
</style>

<body>

<header>
    <h1>Command</h1>
    <div class="subtitle">
        <p>170722_223101</p>
        <p><iframe src="./170721_194059.html" class="ifrmRefDest"></iframe></p>
    </div>
</header>

<section class="section1" id="toc">
    <h2><iframe class="ifrmRefDest" src="170723_110344.html"></iframe><a class="ancrDest" id="d170722_024023"></a></h2>

    <div class="foldableContent">
        <ul>
            <li><strong class="lihed"><a href="#d170722_224937">Nav.</a></strong></li>
            <li><strong class="lihed"><a href="#d170731_082724">tmp command</a></strong></li>
            <li><strong class="lihed">[<b class="code1"><a href="170730_091357.html">apt // aptitude // dpkg</a></b>].</strong></li>
            <li>
                <p><strong class="lihed"><b class="code1">badblocks</b>.<a class="ancrDest" id="d170815_130520"></a></strong></p>
                <ul>
                    <li><strong class="lihed">How to check the physical health of a USB stick like <b class="code1">S.M.A.R.T</b> test?</strong> : See <a href="https://superuser.com/questions/376274/how-to-check-the-physical-health-of-a-usb-stick-in-linux">here</a>, <a href="https://en.wikipedia.org/wiki/Badblocks">wiki</a>, <a href="https://askubuntu.com/questions/539184/how-do-i-check-the-integrity-of-a-storage-medium-hard-disk-or-flash-drive">detail explain</a>, basically USB flash drive can't use <b class="udr">smart-like</b> test (such us linux utility <b class="code1">smartmontools</b>) because it only work on hard drive. You can use <b class="code1">badblocks</b>.</li>
                    <li><strong class="lihed">[<b class="code1">-n</b> // <b class="code1">-w</b>]</strong> : <b class="code1">-n</b> is <b class="strong1">non-destructive</b> read-write mode, it will read and write data but will keep original data safe (will write over it but copy back later), this is safe to use even you still have data you need in device. _ In other way <b class="code1">-w</b> is <b class="strong1">destructive</b> read-write mode, using <b class="code1">-w</b>  will <b class="udr">destroy all data inside this device</b>! _ Remember to umount all partition before action.</li>
                    <li><strong class="lihed">Also see <b class="code1"><a href="#d170815_130521">fsck</a></b>.</strong></li>
                </ul>
            </li>
            <li><strong class="lihed"><b class="code1">bash</b></strong>
                <ul>
                    <li><strong class="lihed"><b class="code1">shopt -s dotglob</b></strong> : Make <b class="code1">cp</b> and <b class="code1">rm</b> to include hidden file. _ See <a href="https://superuser.com/questions/61611/how-to-copy-with-cp-to-include-hidden-files-and-hidden-directories-and-their-con/547166#547166">here</a> for more info</li>
                </ul>
            </li>
            <li>
                <p><strong class="lihed"><b class="code1">chroot</b><a class="ancrDest" id="d170810_144512"></a></strong></p>
                <div class="cbk1 hide">
                    <ul>
                        <li><a href="https://wiki.debian.org/chroot">wiki.debian.org/chroot.</a></li>
                        <li><a href="https://help.ubuntu.com/community/Grub2/Installing#via_ChRoot">Ubuntu Grub2/Installing - via ChRoot</a>.</li>
                        <li>
                            <p><strong class="lihed">I tested chroot to an empty directory, it works.</strong></p>
                            <div class="cbk1">
                                <p>This was steps I use</p>
                                <div class="cbk1">
                                    <ul>
                                        <li>I use live OS, but doesn't matter, real OS will works too.</li>
                                        <li>create empty directory <b class="code1">chrootTest</b> first, then create these sub directories <b class="code1">bin proc dev sys etc lib <b class="strong1">lib64</b> usr run var sbin </b> under <b class="code1">chrootTest</b>.</li>
                                        <li><b class="code1">cd chrootTest</b>, use <b class="code1">for i in $(\ls) ; do sudo mount --bind /$i ./$i ; done</b> to mount all these directory at once.</li>
                                        <li>Mount /dev/pts too <b class="code1">sudo mount /dev/pts/ ./dev/pts/</b>. I don't know why <b class="code1">/dev/pts/</b> is empty even after <b class="code1">/dev</b> been mount.</li>
                                        <li>Finally <b class="code1">sudo chroot .</b> .</li>
                                    </ul>
                                </div>
                                <p>This will <b class="code1">chroot</b> successfully, and all operation <b class="udr">seems to <b class="strong1">effect original OS</b></b>! For example <b class="code1">aptitude install</b> indeed effect the original OS and install package will take effect!</p>
                                <p>I tried to apply <b class="code1">-o ro</b> to all <b class="code1">mount</b> operation, and it indeed protect original OS from being writed, but it is obvious in chroot system it will report some error when using aptitude installing package so installation fail.</p>
                                <p>If I don't mount <b class="code1">/dev/pts</b> in last step there will have little error message complaining when using aptitude installing package.</p>
                                <p>I know I actually don't have to mount so many directory to work, but I'm not sure <b class="strong1">how many</b> essential directory I need at least, I have not test yet.</p>
                                <p><b class="code1">lib</b> and <b class="code1">lib64</b> must be mounted too in order to make it work, because for example use <b class="code1">ldd /bin/bash</b> you can see <b class="code1">/bin/bash</b> <a href="https://serverfault.com/questions/162362/chroot-fails-cannot-run-command-bin-bash-no-such-file-or-directory">need extra library to work</a>.</p>
                            </div>
                        </li>
                        <li><a href="https://serverfault.com/questions/136515/read-only-bind-mount">Read only bind-mount when chroot?</a></li>
                        <li>Examples on <a href="https://wiki.debian.org/Debootstrap#line-19">Debootstrap page</a> you can see same logic to use chroot.</li>
                        <li>Examples on <a href="https://unix.stackexchange.com/questions/72592/chroot-in-to-reinstall-grub2-reinstall-mnt-is-empty#72599">this</a> and <a href="https://hugh712.gitbooks.io/grub/content/fixing-a-broken-system.html#via-chroot">this</a>, again you see same logic to use chroot, which mounting these direcotry <b class="code1">/proc</b>, <b class="code1">/dev</b>, <b class="code1">/dev/pts</b>, <b class="code1">/sys</b>, <b class="code1">/run</b> ... (might be different or more) is needed to make chroot system works.</li>
                        <li>Examples on <a href="https://youtu.be/8lod8sRb_6I">this video </a>, again you see same logic to use chroot to reinstall <b class="code1">Grub</b>, with mounting these direcotry <b class="code1">/proc</b>, <b class="code1">/dev</b>, <b class="code1">/sys</b>, and the chroot target is a real system, not empty partition.</li>
                        <li><strong class="lihed"><b class="code1">/bin</b>, <b class="code1">/lib</b></strong> : See <a href="https://www.experts-exchange.com/questions/20696260/How-to-use-chroot.html#a9044562">here ("XoF" 's answer)</a>, it seems not only commonly seen <b class="code1">/proc</b>, <b class="code1">/dev</b>, <b class="code1">/sys</b>, I even need <b class="code1">/bin</b>, <b class="code1">/lib</b> to work. It is very possible I need all root direct sub direcotry to be [mount // exist] before <b class="code1">chroot</b>.</li>
                        <li><strong class="lihed"><a href="https://unix.stackexchange.com/questions/105/chroot-jail-what-is-it-and-how-do-i-use-it">chroot "jail" - what is it and how do I use it?</a></strong> : This shows even <b class="code1">/lib</b> and <b class="code1">/usr/lib</b> could be mount into chroot environment.</li>
                        <li><strong class="lihed"><b class="code1">/dev/pts</b>, <b class="code1">/proc</b>, <b class="code1">/sys</b>, <b class="code1">/dev/shm</b></strong> : See <a href="https://superuser.com/questions/529618/what-are-these-devpts-proc-sysfs">here</a>. <q>{/dev/pts: contains pseudo terminal devices (that's why Konsole, GNOME Terminal, etc. are terminal emulators) ; /proc and /sys: exposes kernel's data structures to the userspace ({/proc: mainly process-related stuff ; /sys: devices, drivers and kernel settings}) ; /dev/shm: provides file-based shared memory (basically a RAM disk).</q></li>
                        <li><strong class="lihed"><a href="https://superuser.com/questions/165116/mount-dev-proc-sys-in-a-chroot-environment"><b class="code1">mount --bind /proc &lt;chroot-dir&gt;/proc</b> vs <b class="code1">mount -t proc none /proc</b>, what are the difference?</a></strong></li>
                        <li><strong class="lihed"><a href="http://www.tldp.org/LDP/Linux-Filesystem-Hierarchy/html/proc.html">[<b class="code1">/proc</b> / Linux Filesystem Hierarchy</a></strong> : Very detailed explain about <b class="code1">/proc</b>. I mostly don't need it, just FYI.</li>
                        <li><strong class="lihed"><a href="https://sites.google.com/site/linuxpendrive/rorootfs">Read-only Root Filesystem</a></strong> : Very bold [experiment / practice] to use <b class="code1">chroot</b>, it made <b class="udr">file system root read only</b>. Also showing some practice. _ I don't need this practice this but is is good to have another view.</li>
                        <li><strong class="lihed"><a href="https://unix.stackexchange.com/questions/41889/how-can-i-chroot-into-a-filesystem-with-a-different-architechture">You cannot chroot into different architecture.</a></strong></li>
                    </ul>
                </div>
            </li>
            <li><strong class="lihed"><b class="code1">curl</b></strong> : <b class="code1">curl -C - -L -O &lt;URL&gt;</b> to resume from the point where it failed when download aborts, see <a href="https://www.debian.org/CD/http-ftp">here</a>.</li>
            <li>
                <p><strong class="lihed"><b class="code1">dd</b>.</strong></p>
                <div class="cbk1">
                    <ul>
                        <li>
                            <p><strong class="lihed">Reclaiming <b class="udr">MBR</b>.</strong></p>
                            <p><q>You may have noticed that the MemTest86 USB drive you have created may have lost some disk space and normal formatting will not recover the lost space. For example, this can happen when a UFD contains multiple partitions, such as the MemTest86 image. Formatting will not span across multiple partitions/volume. To erase the partition records and reclaim the whole disk, you will need to zero the MBR.</q></p>
                            <p><b class="code1">dd if=/dev/zero of=&lt;dev&gt; bs=512 count=1</b>.</p>
                        </li>
                        <li><strong class="lihed"><a href="https://askubuntu.com/questions/666527/install-grub-claims-that-i-have-multiple-partiton-labels-and-that-embedding-is">Reclaiming <b class="udr">post-MBR gap</b></a><a class="ancrDest" id="d170821_090545"></a></strong> : Sometimes you got problem your USB flash drive not work properly, there is some reason you have to wipe out <b class="udr">post-MBR gap</b> clean and USB flash drive will "works" again.</li>
                    </ul>
                </div>
            </li>
            <li>
                <p><strong class="lihed"><b class="code1">df</b>.</strong></p>
                <div class="cbk1 hide">
                    <ul>
                        <li><strong class="lihed">df show nothing?</strong> : Use <b class="code1">lsblk</b> or <b class="code1">dmesg</b> to see your target [disk / partition] first, then mount it, then finally use <b class="code1">df</b> to see disk size usage.
                        <p>df will not showing partition without mounted, <s>so for example when you are using live usb, you only see other usb stick (/dev/sdn) showing up, but don't see yor main disk showing up, because when you plug in any usb stick, Gnome normally AUTOMATIC mount it for you under /media.</s></p>
                        </li>
                    </ul>
                </div>
            </li>
            <li><strong class="lihed"><b class="code1">dmesg</b><a id="d170808_084719"></a></strong> : This is very usful because some time error occurs you can find the log here.</li>
            <li>
                <p><strong class="lihed"><b class="code1">fsck</b><a class="ancrDest" id="d170815_130521"></a></strong></p>
                <div class="cbk1 hide">
                    <ul>
                        <li><strong class="lihed"><a href="https://blog.gtwang.org/linux/linux-fsck-examples/">fsck 指令範例教學 - blog.gtwang.org</a></strong> : (informative).</li>
                        <li><strong class="lihed"><a href="http://wiki.linux.org.hk/w/Check_filesystem">檢查檔案系統 (Filesystem Check, fsck) - Hong Kong Linux User Group</a></strong> : (informative).</li>
                        <li><strong class="lihed"><a href="http://www.thegeekstuff.com/2012/08/fsck-command-examples/">10 Linux Fsck Command Examples to Check and Repair Filesystem.</a></strong></li>
                        <li><strong class="lihed"><a href="https://wiki.archlinux.org/index.php/Fsck">arch wiki</a>.</strong></li>
                        <li><strong class="lihed">Always add target at the end</strong> : Remember to add target at the end of command (for example <b class="udr">/dev/sdb2</b>), or fsck will traval all partition according to <b class="code1">fstab</b>.</li>
                        <li><strong class="lihed">Always specify partition number</strong> : Remember to use <b class="code1">/dev/sdxn</b> instead of <b class="code1">/dev/sdx</b>.</li>
                        <li>
                            <p><strong class="lihed"><b class="code1">-f</b></strong> : 強制檢查 Clean 的檔案系統. 每當檔案系統被掛載成讀寫模式（rw）時，檔案系統狀態會被設定為 not-clean，而在檔案系統被成功卸載後，其狀態就會被設定回 clean。所以檔案系統沒有被成功卸載或者運作中途系統被中斷等，狀態就會維持在 not-clean，當檔案系統下次被檢查時，就可以由檔案系統狀態得知檔案系統是否有被正常卸載。</p>
                            <p>在預設的狀況下，fsck 只會對狀態為 not-clean 的檔案系統進行檢查，如果碰到狀態為 clean 的檔案系統，就會很快地跳過。如果想要讓它檢查 clean 的檔案系統，可以加上 -f 參數。</p>
                        </li>
                        <li><strong class="lihed">A log</strong> : I had run <b class="code1">fsck</b>. Before this <b class="code1">dmesg</b> prompting some error but after this it fixed the partition.</li>
                        <li><strong class="lihed">Also see <b class="code1"><a href="#d170815_130520">badblocks</a></strong></b>.</li>
                    </ul>
                </div>
            </li>
            <li>
                <p><strong class="lihed"><b class="code1">grep</b>.</strong></p>
                <ul>
                    <li><strong class="lihed"><b class="code1">-C</b></strong> : e.g. <b class="code1">grep -C 3</b> = <b class="code1">grep -A 3 -B 3</b>.</li>
                    <li><strong class="lihed"><b class="code1">-l</b></strong> : Only output the file name of current matched pattern when searching a file, not matched pattern itself. Practice example like this - <b class="code1 mono">grep -lr "new User" * | xargs sed -i s/new User/new Account/g'</b>.</li>
                </ul>
            </li>
            <li>
                <p><strong class="lihed"><b class="code1">Groff.</b></strong></p>
                <div class="cbk1 hide">
                    <ul>
                        <li>Groff (GNU troff) is a typesetting/(typeset) system that reads plain text mixed with formatting commands and produces formatted output. Output may be PostScript or PDF, html, or ASCII/UTF8 for display at the terminal.</li>
                        <li><a href="https://www.gnu.org/software/groff/manual/">Online manual.</a></li>
                        <li>
                            <p><strong class="lihed"><b class="code1">Tex (or LaTax) vs Groff?</b></strong></p>
                            <ul>
                                <li>Groff is firmly entrenched in all UNIX/Linux systems.</li>
                                <li><q>If you need to run the thing in a pipeline, this is your baby.
Table processing is simpler (but I think gtbl can write TeX output...)</q></li>
                                <li><q>I run/schedule 'canned' PDF reports using *roff, generating tables and simple PICs as I process the data with python, and organizing sources with simple bash scripts. Smooth & Simple. Like vi, *roff is always there, ready-to-run and generates clean PDFs with minimal fuss.</q></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </li>
            <li><strong class="lihed"><b class="code1">ldconfig</b></strong> : ldconfig - configure dynamic linker run-time bindings ... ldconfig creates the necessary links and cache to the most recent shared libraries found in the directories specified on the com‐
       mand line, in the file /etc/ld.so.conf, and in the trusted directories, /lib and /usr/lib  ...</li>
            <li><strong class="lihed"><b class="code1">ldd</b></strong> : Prints  the  shared  objects (shared libraries) required by each program or shared object specified on the command line.</li>
            <li><strong class="lihed"><b class="code1">lsb_release</b></strong> : Print distribution-specific information e.g. current distribution release name.</li>
            <li><strong class="lihed"><b class="code1">lspci -nn</b></strong> : Check device basic info (name) like (VGA) graphic card name, product code, vendor name ... If you want to install [firmware / driver] you have to at least to know it's product code first. _ Also see <a href="170721_170002.html#d170808_095225">here</a></li>
            <li>
                <p><strong class="lihed"><b class="code1">mount</b><a class="ancrDest" id="d170810_172759"></a></strong></p>
                <ul>
                    <li><strong class="lihed"><b class="code1">loop</b></strong> : e.g. <b class="code1">ISO</b> image, use <b class="code1">mount -o loop,ro /src /dest</b> and you cant read content inside ISO image. _ FYI, using <b class="code1">dd</b> and <b class="code1">losetup</b> can created a loop file filesystem, but not too related to this.</li>
                    <li><strong class="lihed"><b class="code1">lsof</b></strong> : Sometimes you don't leave you terminal CWD and umount complain about it. You can use <b class="code1">lsof</b> to find the occupying one, but use lazy umount <b class="code1">umount -l</b> could be more easy.</li>
                </ul>
            </li>
            <li><strong class="lihed"><b class="code1"><a href="#d170809_125302">parted.</a></b></strong></li>
            <li><strong class="lihed"><b class="code1">/proc/meminfo</b></strong> : Including <b class="udr">MemTotal</b>, <b class="udr">MemAvailable</b>, <b class="udr">SwapTotal</b>, <b class="udr">SwapFree</b> ... and many other memory usage type.</li>
            <li>
                <p><strong class="lihed"><b class="code1">qemu-kvm</b></strong></p>
                <ul>
                    <li><strong class="lihed"><a href="https://newtoypia.blogspot.tw/2015/02/qemu-kvm.html">洪朝貴</a></strong> : <q>現在的 PC 上面有很多虛擬化技術 ... 但是如果你只是想測試一下開機光碟或開機隨身碟， 而沒有要把 guest OS 安裝到硬碟上， 那麼最簡單、 最不囉嗦的方式就是使用 qemu - 一個指令啟動， 免設定!</q></li>
                    <li><strong class="lihed">Dependent Kernel module</strong> : At least need <b class="code1">kvm</b> and <b class="code1">kvm-intel</b>. insmod if module is not installed to Kernel. _ <q>the 'kvm' module is just the generic support, then you need kvm-intel or kvm-amd to actully drive it. _ yes. in BIOS you must enable intel virtualization technology (i don't know for amd processors) to be able to use kvm. i heard that there are also systems with processors suporting IVT but the BIOS doesn't support it so you can't use it  <cite><a href="https://bbs.archlinux.org/viewtopic.php?id=29981">source</a></cite></q></li>
                    <li><strong class="lihed">Check if hardware support</strong> : Use <b class="code1">egrep 'vmx|svm' /proc/cpuinfo</b> (vmx = intel CPU, svm = amd CPU) to check if your cpu support it. And don't forget to enable it in your [UEFI / BIOS]!</li>
                </ul>
            </li>
            <li><strong class="lihed"><b class="code1"><a href="#d170723_173307">rsync</a></b>.</strong></li>
            <li><strong class="lihed"><b class="code1">tr</b></strong> : Replace <b class="udr">newline</b> to <b class="udr">null</b> character you can use <b class="code1 mono">\grep -R -l '&lt;pattern1&gt;' &lt;a dir&gt; | <b class="strong1">tr '\n' '\0' | xargs -0</b> -I {} sed 's/'&lt;pattern1&gt;'/'&lt;pattern2&gt;'/g' "{}"</b></li>
            <li><strong class="lihed"><b class="code1"><a href="http://linuxcommand.org/tlcl.php">linuxcommand.org</a></b></strong> : A good free book about many basic command useful application example, when you want to improve your skills of using these tools.</li>
        </ul>
    </div>
</section>

<section class="section1">
    <h2>rsync<a class="ancrDest" id="d170723_173307"></a></h2>

    <div class="foldableContent">
        <ul>
            <li><strong class="lihed"><a href="https://www.howtogeek.com/175008/the-non-beginners-guide-to-syncing-data-with-rsync/">Incremental backup</a></strong>.</li>
            <li>
                <p><strong class="lihed">My Important Final Conclusion.</strong></p>
                <div class="cbk1">
                    <ul>
                        <li>Don't use <b class="code1">-f '+sr_'</b>, <b class="code1">-f '-rs'</b> any more, it is over complicate and not much benifit to general usage tough it can works.</li>
                        <li>Use <b class="code1">--include</b> and <b class="code1">--exclude</b>. This works similar to <b class="code1">-f '+sr_'</b> and <b class="code1">-f '-rs'</b>, it will always represent both <b class="code1">s</b> (send) and <b class="code1">r</b> (receive) sides on current "filter pattern". You don't need to specify [s // r] one side only in most of case.</li>
                        <li>Use <b class="code1">--include-from</b> and <b class="code1">--exclude-from</b> when you have too much "filter pattern" and you don't want to put them in command line casing too hard to [usr // read]. See <a href="http://www.thegeekstuff.com/2011/01/rsync-exclude-files-and-folders/">here</a> for simple example.</li>
                        <li>Use <b class="code1">***</b> instead of <b class="code1">**</b>, because 3 asterisk will not only "cross slashs" include content (file), but also DIRECTORY, while 2 asterisk will "cross slashs" include only content (file). So using <b class="code1">***</b> in <b class="code1">--include</b> "filter", you don't need to have <b class="code1">--include="**/"</b> before it anymore. This also make command more simple to use.</li>
                        <li>After using <b class="code1">***</b>, you don't need to use <b class="code1">-m</b> (prune).</li>
                        <li>Use <b class="code1">--include</b> and <b class="code1">--exclude</b> when you only care about to sync specific [directories // files] and ignore others, in <b class="strong1">BOTH (SRC) SEND AND (DEST) RECEIVE side</b>, this is say, consider this <b class="code1">src</b> and <b class="code1">dest</b> structure :
                            <ul>
                                <li><b class="code1">src</b> contain : <b class="code1">1.dir 2.txt 3.dir 4.txt 5.dir 6.txt</b>.</li>
                                <li><b class="code1">dest</b> contain : <b class="code1">3.dir 4.txt 7.dir 8.txt</b></li>
                            </ul>
                            <p>And using : <b class="code1 mono">-a --include="1.dir/***" --include="2.txt" --include="3.dir/***" --include="4.txt" --exclude="***" --delete</b>, the result of <b class="code1">dest</b> will look like this :</p>
                            <ul>
                                <li><b class="code1">dest</b> contain : <b class="code1">1.dir (New) 2.txt (New) 3.dir (Update) 4.txt (Update) 5.dir (ignore) 6.txt (ignore) 7.dir (ignore) 8.txt (ignore)</b>.</li>
                            </ul>
                            <p>Use these 2 options when you only want to sync target [directories // files] and ignore others, in <b class="strong1">BOTH SIDES</b>.</p>
                        </li>
                        <li><strong class="lihed">Filter Priority and how [directory // file] works.</strong>
                            <ul>
                                <li>Preceding filter will have higher priority (if following filter have same content conflict to preceding filter, conflicted content in following filter will ignore (and non conflicted will still affect. This rule apply ot both file and directory (I'm not sure about directory, but I guess I'm right).</li>
                                <li>When you only need to include some [file / director], <b class="code1">target-dir/**</b> patterns need <b class="code1">**/</b> patterns to be set fist to able to work or it will not work (see here for why but you can ignore this : https://unix.stackexchange.com/questions/2161/rsync-filter-copying-one-pattern-only/2503#2503 ).
                                    <p>But you don't need to care about this anymore because you can now use <b class="code1">--include="target-dir/***" --exclude="***"</b>, instead of <b class="code1">--include="**/" --include="target-dir/**" --exclude="**"</b>.</p>
                                </li>
                                <li>Directory and file is speerate thing for rsync, that is why you need to put <b class="code1">--include="**/"</b> first when you want to inclde some filter.</li>
                            </ul>
                        </li>
                        <li>
                            <p><strong class="lihed">Best [practice / example].</strong></p>
                            <div class="cbk1">
                                <ul>
                                    <li>this example is most common used case for these 2 usage :
                                        <ul>
                                            <li><b class="udr">Include several targets but include (ignore) all other contents</b>, and</li>
                                            <li><b class="udr">Include all contents but exclude (ignore) several targets</b>.</li>
                                        </ul>
                                    </li>
                                    <li><strong class="lihed">Include several targets but exclude (ignore) all other contents</strong> : <b class="code1 mono">rsync -a -zhv --delete --dry-run --include "target1/***" --include "target2/***" --exclude "***" src/ dest/ 1&gt; &gt;(tee /tmp/tmp/rsync-stdout.txt) 2&gt; &gt;(tee /tmp/tmp/rsync-stderr.txt)</b>.</li>
                                    <li><strong class="lihed">Include all contents but exclude (ignore) several targets</strong> : <b class="code1 mono">rsync -a -zhv --delete --dry-run --exclude "target1/***" --exclude "target2/***" src/ dest/ 1&gt; &gt;(tee /tmp/tmp/rsync-stdout.txt) 2&gt; &gt;(tee /tmp/tmp/rsync-stderr.txt)</b>.</li>
                                    <li>Always aware about "ignore" is not only mean at <b class="code1">src</b>, but ignore at <b class="code1">dest</b> too!</li>
                                    <li>Second method is useful for dealing with <b class="code1 mono">lost+found</b> and <b class="code1 mono">.Trash-1000</b> directory, these 2 are either useless or possible permission denied.</li>
                                    <li>If excluding <b class="code1 mono">lost+found</b>, use <b class="code1 mono">--exclude="lost+found"</b>, don't use <b class="code1 mono">--exclude="lost+found/***"</b>, becasue when rsync try to get inside the directory, it will get <b class="udr">"Permission denied"</b>. Actually, <b class="code1">--exclude</b> directory don't need to have trailing <b class="code1">***</b> and it will still work fine.</li>
                                </ul>
                            </div> 
                        </li>       
                        <li><strong class="lihed"><b class="code1">stdout</b>.</strong>
                            <ul>
                                <li>Even without <b class="code1">-P</b> you still can see the result statistic (total size, sent, received) and also "deleting" keyword in stdout too. Just using <b class="code1">-v</b> is fine.</li>
                                <li><b class="code1">deleting</b>, not "delete", "remove" or "removing" string, will showing up in stdout when deleted a file (and directory too?).</li>
                                <li>All the path in stdout, if path end with <b class="code1">/</b>, it do nothing (or maybe add a directory?), but if end with other character like <b class="code1">.jpg</b>, <b class="code1">.txt</b>, it means that file are new copy from <b class="code1">src</b> to <b class="code1">dest</b>.</li>
                            </ul>
                        </li>
                        <li><strong class="lihed"><b class="code1">ssh</b>.</strong>
                            <ul>
                                <li><strong class="lihed">Example of AWS</strong> : <b class="code1">rsync -a -zhv -e 'ssh -i /mnt/rt/2_Wa/aws/awsTreegbFirstInstancePrivateKey.pem' /tmp/tmp/ admin@ec2-52-72-238-180.compute-1.amazonaws.com:/tmp/tmp/</b>. This send data from home to AWS.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </li>
            <!-- ** End of My <Important Final Conclusion>. -->
        </ul>
    </div>
</section>

<section class="section1">
    <h2>tmp command<a class="ancrDest" id="d170731_082724"></a></h2>

    <div class="foldableContent">
        <ul>
            <li><strong class="lihed"><b class="code1">[source / temporary method]</b></strong> : <b class="code1">source /mnt/sda5/1_script_command_config/config/bash-config/bash_aliases_main</b>.</li>
            <li><strong class="lihed"><a href="170721_170001.html">asKansweR info and script.</a></strong></li>
            <li><strong class="lihed"><b class="code1">date</b></strong> : <b class="code1">date +"d%y%m%d_%H%M%S"</b>.</li>
            <li><strong class="lihed">Search dokuwiki page</strong> : <b class="code1">egrep -iR --color=always -A3 -B3 'florian bur' . | less -MiR -j3</b>.</li>
            <li><strong class="lihed">rsync to purple disk (ALWAYS BE CAUTIOUS!)</strong> : <b class="code1 mono">sudo rsync -avzh --delete --dry-run --exclude "var_www_backup/" --exclude "lost+found/" --exclude ".Trash-1000/" /mnt/sda5/ /mnt/purple/extra-backup_2017-07-18/rt/ 1> >(tee /tmp/tmp/rsync-stdout.txt) 2> >(tee /tmp/tmp/rsync-stderr.txt)</b>.</li>
        </ul>
    </div>
</section>

<section class="section1">
    <h2>Parted<a class="ancrDest" id="d170809_125302"></a></h2>

    <div class="foldableContent">
        <ul>
            <li><strong class="lihed">Before and after "parted"</strong> : Use <a href="https://www.debian.org/releases/stable/amd64/ch04s03.html#idm46300558336592"><b class="code1">install-mb</b> (not necessary) and <b class="code1">mkfs.&lt;fs-type&gt;</b></a> before and after using <b class="code1">parted</b>. <b class="code1">mkpart</b> in <b class="code1">parted</b> will not actually create file system on the partition but only change the ["partition code?" / "partition ID?"] of it.</li>
            <li><strong class="lihed"><a href="https://wiki.archlinux.org/index.php/Partitioning">[Partitioning / arch wiki]</a></strong> : Don't underestimate the detail and nuance knowledge need to know to solve some problem when working with partition, especially UEFI and GPT stuff ...</li>
            <li><strong class="lihed"><a href="https://blog.gtwang.org/linux/parted-command-to-create-resize-rescue-linux-disk-partitions/2/">Parted basic simple usage example.</a></strong></li>
            <li><strong class="lihed"><a href="https://www.gnu.org/software/parted/manual/parted.html">GNU Parted User Manual</a></strong> : Simple and detailed.</li>
            <li><strong class="lihed"><b class="code1">help</b></strong> : Use <b class="code1">help <function></b> (inside <b class="code1">parted</b>) to get the much more detail information of <b class="code1">parted</b> function, info here is much detailed than <b class="code1">man</b>, for e.g. <b class="code1">help mkpart</b> will show what partition type and file system tyle you can use.</li>
            <li><strong class="lihed">End point</strong> : Use <b class="code1">-1s</b> or <b class="code1">100%</b> to set end point to max size of rest space of disk. ("s" stand for sector, you can use <b class="code1">unit</b> to change unit too.)</li>
            <li><strong class="lihed">label</strong>
                <ul>
                    <li>Notice, most common used <b class="code1">[disk label / label type]</b> on PC are <b class="code1">msdos</b>, you are mostly going to set to this. <b class="code1">gpt</b> is for purpose when are used if disk size is larger than 2TB.</li>
                    <li><a href="https://www.gnu.org/software/parted/manual/html_node/mklabel.html"><b class="code1">mklabel</b> - gnu.org.</a></li>
                </ul>
            </li>
            <li><strong class="lihed"><b class="code1">["partition code?" / "partition ID?" / "GUID"]</b></strong> : These info is very shattered, but <a href="https://wiki.archlinux.org/index.php/GNU_Parted#Partition_schemes">0x83</a> = <a href="https://en.wikipedia.org/wiki/Partition_type#PID_83h">83h</a>. GUID list is <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs">here</a>, but don't match <a href="https://www.gnu.org/software/grub/manual/html_node/BIOS-installation.html">this GUID</a>.</li>
            <li>
                <p><strong class="lihed"><b class="code1">Grub</b> problem.</strong><a class="ancrDest" id="d170809_131918"></a></p>
                <ul>
                    <li>Go to <a href="170721_170002.html#d170809_133501">here</a> of you want to see <b class="code1">grub</b> document only.</li>
                    <li><strong class="lihed"><b class="code1"><a href="https://wiki.archlinux.org/index.php/EFI_System_Partition">EFI System Partition</a></b></strong> : Creating a special partition for bootloader in <b class="strong1">necessary</b> for [UEFI motherboard? / GPT partition table disk?]. Not like MBR partition table,<b class="code1">Grub</b> are limited to embed in small "space" in disk.</li>
                    <li>
                        <p><strong class="lihed">Where <b class="code1">Grub</b> pysically installed to (location)?</strong> : See <a href="https://www.gnu.org/software/grub/manual/html_node/BIOS-installation.html">here</a>, <a href="https://wiki.archlinux.org/index.php/GRUB#GUID_Partition_Table_.28GPT.29_specific_instructions">here</a>, <a href="https://askubuntu.com/questions/657179/where-is-grub-installed-on-a-gpt-disk">here</a>, and <a href="https://newtoypia.blogspot.tw/2015/02/extlinux.html">this [MBR // VBR] concept figure?</a>. <b class="code1">[BIOS / MBR]</b>, <b class="code1">[BIOS / GPT]</b> and <b class="code1">[UEFI / GPT]</b> work different.</p>
                        <p>In <b class="code1">MBR</b> patition table disk, <b class="code1">Grub</b> is partly [install / embed] in <b class="udr"><a href="https://wiki.archlinux.org/index.php/GRUB#Master_Boot_Record_.28MBR.29_specific_instructions">post-MBR gap</a></b> and partly (but mainly) install under <b class="code1">/boot</b> (and maybe files in other path) in the file system which one get control from first-stage grub program.
                        <p>In <b class="code1">GPT</b> patition table disk, <b class="code1">Grub</b> need to install <b class="udr">after</b> this partition was created.</p>
                    </li>
                    <li><strong class="lihed">flag <b class="code1">bios_grub</b></strong> : So now we get conclusion, Parted <a href="https://www.gnu.org/software/grub/manual/html_node/BIOS-installation.html">can create</a> special partition with flag <b class="code1">bios_grub</b>, [if / when] some case need this partition (namely <b class="code1">[UEFI / GPT]</b>, but <b class="code1">[BIOS / GPT]</b> I'm not sure).</li>
                </ul>
            </li>
            <li><strong class="lihed"><b class="code1">mkpart</b></strong> : Creates a new partition, WITHOUT creating a new file system on that partition. _ You need to use other tools like <b class="code1">mkfs.[ext4 // ntfs // fat (= msdos, vfat)]</b> to do it.</li>
            <li><strong class="lihed"><a href="https://wiki.archlinux.org/index.php/GNU_Parted#Rounding">Rounding and units</a></strong> : Since many partitioning systems have complicated constraints, Parted will usually do something slightly different to what you asked. _  You should prefer to specify units of bytes (“B”), sectors (“s”), or IEC binary units like “MiB”, but not “MB”, “GB”, etc.</li>
            <li><strong class="lihed"><a href="https://wiki.archlinux.org/index.php/GNU_Parted#Check_alignment">Check alignment</a></strong> : On an already partitioned disk, you can use parted to verify the alignment of a partition on a device. For instance, to verify alignment of partition 1 on /dev/sda: <b class="code1">(parted) align-check optimal 1</b>.</li>
            <li><strong class="lihed"><a href="https://www.gnu.org/software/grub/manual/html_node/BIOS-installation.html">First partition is suggested to start after 1MB of begining.</a></strong></li>
            <li><strong class="lihed"><a href="https://www.gnu.org/software/parted/manual/html_node/mkpart.html#FOOT2">4MB begining of USB, don't use it</a></strong> : If USB drive, leave 4MB at the begining and don't use it?</li>
            <li><strong class="lihed">Following command had been removed</strong> : Note that after version 2.4, the following commands were removed: check, cp, "mkfs", "mkpartfs", move, resize.</li>
            <li><strong class="lihed"><a href="https://wiki.archlinux.org/index.php/Fdisk#Convert_between_MBR_and_GPT">Convert between MBR and GPT</a></strong> : I don't need to do this now.</li>
        </ul>
    </div>
</section>

<section class="section1">
    <h2>Nav<a class="ancrDest" id="d170722_224937"></a></h2>

    <div class="foldableContent">
        <iframe class="ifrmRefDest" src="170721_194101.html"></iframe>
    </div>
</section>



<script type="text/javascript" src="../js/js_coreNote_001.js"></script>

</body>
</html>
